// URL to fetch games
const zonesUrl = "https://cdn.jsdelivr.net/gh/gn-math/assets@main/zones.json";
const COVER_BASE = "https://cdn.jsdelivr.net/gh/gn-math/covers@main";
const HTML_BASE = "https://cdn.jsdelivr.net/gh/gn-math/html@main";

// Fetch game list
fetch(zonesUrl)
  .then(res => res.json())
  .then(data => {
    const games = [];

    data.forEach(item => {
      // Only include games with real playable URLs
      if (item.id >= 0 && item.url && item.cover) {
        const cover = item.cover
          .replace("{COVER_URL}", COVER_BASE);
        const url = item.url
          .replace("{HTML_URL}", HTML_BASE);

        games.push({
          id: item.id,
          name: item.name,
          cover,
          url
        });
      }
    });

    // Now populate your games container
    const gamesContainer = document.getElementById("gamesContainer");
    gamesContainer.innerHTML = "";

    games.forEach(game => {
      const card = document.createElement("div");
      card.className = "game-card";
      card.innerHTML = `
        <img src="${game.cover}" class="game-icon">
        <div class="game-title">${game.name}</div>
      `;
      
      card.addEventListener("click", () => {
        // Load game in iframe
        mainFrame.src = game.url;
        iframeContainer.style.display = "block";
        welcomeContainer.style.display = "none";
        gamesContainer.style.display = "none";
        urlDisplay.textContent = game.name;

        // Save to current tab data if desired
        tabsData[currentTab] = { url: game.url, searchQuery: null, showGames: true };
      });

      gamesContainer.appendChild(card);
    });
  })
  .catch(err => {
    console.error("Failed to load games:", err);
  });
